{% extends 'home/base.html' %}
{% load static %}
{% block content %}

<section style="background-color: #f4f5f7;">
  <div class="container-fluid py-5 d-flex justify-content-center">
    <div class="w-75 card mb-3 rounded">
      <div class="row g-0">
        <!-- Photo Section -->
        <div class="col-12 col-md-4 gradient-custom text-center text-white py-5"
          style="border-top-left-radius: .5rem; border-bottom-left-radius: .5rem;">
          <img src="{{profileuser.get_profile_picture}}" 
          onerror="this.onerror=null;this.src='/media/account/images/annon.png';" 
          alt="Avatar" class="img-fluid my-3 rounded-circle" style="width: 120px;" />
          <h4 class="text-dark">{{profileuser.fullname}}</h4>
          <p class="text-dark">@{{profileuser.username}}</p>

          {%if profileuser.profile%}
          <div class="text-dark"><i class="fa-solid fa-link me-2"></i>
            <a href="{{profileuser.profile}}" class="text-decoration-none text-dark">{{profileuser.profile}}</a>
          </div>
          {%endif%}

          {% if profileuser.id is user.id %}
          <a href="{% url 'editprofile' %}" class="btn btn-outline-dark my-4" data-mdb-ripple-color="dark"
            style="z-index: 1;"><i class="fa-solid fa-pen-to-square me-2"></i>Edit profile</a>
          <br>
          <a href="{% url 'delete_user' %}" class="btn btn-outline-danger" data-mdb-ripple-color="danger"
            style="z-index: 1;"><i class="fa-solid fa-bomb me-2"></i>Delete profile</a>
          {%endif%}
        </div>

        <!-- Information Section -->
        <div class="col-12 col-md-8">
          <div class="accordion card-body p-4">

            <div class="accordion" id="accordionExample">
              <!-- Personal Info -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                  <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne"
                    aria-expanded="true" aria-controls="collapseOne">
                    Personal Information
                  </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                  >
                  <div class="accordion-body">
                    <div class="row pt-1">
                      <div class="col-6 mb-3">
                        <h6>{{profileuser.email}}</h6>
                        <p class="text-muted">Email</p>
                        {% if profileuser.is_active %}
                        <span class="badge bg-success">Activated</span>
                        {% endif %}
                      </div>
                      <div class="col-6 mb-3">
                        <h6>{{profileuser.phone}}</h6>
                        <p class="text-muted">Phone</p>
                      </div>
                    </div>
                    <div class="row pt-1">
                      {%if profileuser.birthdate%}
                      <div class="col-6 mb-3">
                        <h6>{{profileuser.birthdate}}</h6>
                        <p class="text-muted">Birthday</p>
                      </div>
                      {%endif%}
                      <div class="col-6 mb-3">
                        <h6>{{profileuser.country.name}}</h6>
                        <p class="text-muted">Country</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Projects -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    Projects
                  </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                  >
                  <div class="accordion-body">
                    {% if profileuser.projects %}
                      <div class="list-group list-group-horizontal position-relative overflow-auto" style="height: 55vh;">
                        {%for project in profileuser.projects.all%}
                        <div class="list-group-item border-0">
                          <div class="card position-relative h-100" style="width: 18rem;">
                            {% include "projects/partials/projectinfo.html" with project=project %}
                          </div>
                        </div>
                        {%endfor%}
                      </div>
                    {%else%}
                        <h4 class="d-flex m-0 align-items-center justify-content-center">You have no projects!<a class="m-0 ms-5 btn btn-primary" href="{% url 'project_create' %}" style="margin-bottom: 10px;">Create One Now!</a>
                        </h4>
                    {%endif%}
                  </div>
                </div>
              </div>

              <!-- Donations -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingThree">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                    Donations
                  </button>
                </h2>
                <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                  >
                  <div class="accordion-body">
                    {%if user.donations.all %}
                      {%for donation in user.donations.all%}
                          {% include "projects/partials/donationcard.html" with donation=donation %}
                      {%endfor%}
                    {%else%}
                        <h3>This user has currently no donations!</h3>    
                    {%endif%}
                  </div>

                </div>
              </div>

              <!-- Reviews -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingFour">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    Reviews
                  </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                  >
                  <div class="accordion-body">
                    {%if user.reviews.all %}
                      {%for review in user.reviews.all%}
                          {% include "projects/partials/reviewcard.html" with review=review %}
                      {%endfor%}
                    {%else%}
                        <h3>This user has currently no reviews!</h3>    
                    {%endif%}
                  </div>

                </div>
              </div>              
            </div>
          </div>
        </div>
</section>

{% endblock %}